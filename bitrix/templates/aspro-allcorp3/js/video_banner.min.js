var players={};function pauseMainBanner(){$(".banners-big .main-slider").data("swiper").autoplay.stop()}function playMainBanner(){$(".banners-big .main-slider").data("swiper").params.autoplay.enabled&&$(".banners-big .main-slider").data("swiper").autoplay.start()}function nextSlideMainBanner(){$(".banners-big .main-slider").data("swiper").slideNext()}function startMainBannerSlideVideo(e){var a=e.attr("data-slide_index"),i=e.closest(".main-slider").find('.main-slider__item[data-slide_index="'+a+'"]');if(e.attr("data-video_source")){i.addClass("loading"),pauseMainBanner();var t=e.closest(".main-slider"),n=t.data("slidesIndexesWithVideo");void 0===n&&(n=[]),n.push(a),t.data("slidesIndexesWithVideo",n);var r=e.attr("data-video_src"),d=1==e.attr("data-video_disable_sound"),l=1==e.attr("data-video_loop"),s=1==e.attr("data-video_autoplay"),o=1==e.attr("data-video_cover"),p=(e.attr("data-video_under_text"),e.attr("data-video_player")),y="YOUTUBE"===p,c="VIMEO"===p,u="RUTUBE"===p,v="HTML5"===p,m=!v&&e.attr("data-video_width"),f=!v&&e.attr("data-video_height");if(r&&!e.find(".video").length){var g=function(){for(var e=[],t=0;t<i.length;++t){var n=getRandomInt(100,1e3);e.push(n)}i.each((function(i,t){var n=$(t),g=e[i],w=n.attr("id")+" player_"+g+(o?" cover":"");n.find(".video."+w).length||(y||c?n.append('<div class="wrapper_video"><iframe id="player_'+g+'" class="video '+w+'" src="'+r+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="accelerometer; encrypted-media; gyroscope; fullscreen;"'+(m&&f?' data-video_proportion="'+m/f+'"':"")+"></iframe></div>"):u?(r=r+"&playerid="+g,n.append('<div class="wrapper_video"><iframe id="player_'+g+'" class="video '+w+'" src="'+r+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="encrypted-media; gyroscope; fullscreen;"'+(m&&f?' data-video_proportion="'+m/f+'"':"")+"></iframe></div>")):v&&n.append('<div class="wrapper_video"><video '+(s?"autoplay ":"")+'autobuffer playsinline webkit-playsinline id="player_'+g+'" class="video '+w+'"'+(l?" loop ":"")+(d?" muted ":"")+'><source src="'+r+'" type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\' /><p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video</p></iframe></div>')),void 0!==players&&players&&(players[g]={id:"player_"+g,mute:d,loop:l,cover:o,videoPlayer:p,slideIndex:a,playing:!1,clones:e,videoWidth:m,videoHeight:f,videoProportion:!(!m||!f)&&m/f,src:r},y?window[players[g].id]=new YT.Player(players[g].id,{events:{onReady:function(e){if(g){var a=players[g].mute,i=players[g].cover,t=$("#player_"+g).closest(".main-slider__item"),n=!$("#player_"+g).closest(".swiper-slide-active").length;if((a||n)&&window[players[g].id].mute(),i){if(!players[g].videoProportion){var r=e.target.getVideoEmbedCode();if(r.length){var d=r.match(/width="(\d*)"[^>]*height="(\d*)"/);if(null!==d){var l=d[1],s=d[2];players[g].videoWidth=l,players[g].videoHeight=s,players[g].videoProportion=l/s,t.find(".video").attr("data-video_proportion",players[g].videoProportion)}}}CoverPlayer()}n?setTimeout((function(){e.target.pauseVideo()}),100):(pauseMainBanner(),window[players[g].id].seekTo(0,!0)),t.addClass("started")}},onStateChange:function(e){if(g){var a=players[g].loop;$("#player_"+g).closest(".main-slider__item");if(!$("#player_"+g).closest(".swiper-slide-active").length)players[g].playing=!1,setSlideClasses(g,!1);else if(e.data===YT.PlayerState.PLAYING){players[g].playing=!0,setSlideClasses(g,!0),pauseMainBanner();var i=players[g].clones;for(var t in i)i[t]!=g&&players[i[t]].playing&&window[players[i[t]].id].pauseVideo()}else if(e.data===YT.PlayerState.PAUSED){players[g].playing=!1;var n=Math.floor(10*window[players[g].id].getCurrentTime())/10;setSlideClasses(g,!1),window[players[g].id].seekTo(n,!0);i=players[g].clones;for(var t in i)i[t]!=g&&(players[i[t]].playing&&window[players[i[t]].id].pauseVideo(),"getCurrentTime"in window[players[i[t]].id]&&window[players[i[t]].id].seekTo(n,!0));playMainBanner()}else e.data===YT.PlayerState.ENDED?(players[g].playing=!1,a?e.target.playVideo():playMainBanner()):e.data===YT.PlayerState.UNSTARTED&&(players[g].playing=!1,setSlideClasses(g,!1),e.target.playVideo())}}}}):c?(window[players[g].id]=new Vimeo.Player(document.getElementById(players[g].id),{autopause:!1,byline:!1,loop:!1,title:!1}),window[players[g].id].on("loaded",onVimeoPlayerReady),window[players[g].id].on("play",onVimeoPlayerStateChange),window[players[g].id].on("pause",onVimeoPlayerStateChange),window[players[g].id].on("ended",onVimeoPlayerStateChange)):u?document.getElementById(players[g].id).onload=function(e){var a=this.id.replace("player_","");players[a].contentWindow=this.contentWindow,onRutubePlayerReady(a)}:v&&(document.getElementById(players[g].id).addEventListener("loadeddata",onHtml5PlayerReady),document.getElementById(players[g].id).addEventListener("play",onHtml5PlayerStateChange),document.getElementById(players[g].id).addEventListener("pause",onHtml5PlayerStateChange),document.getElementById(players[g].id).addEventListener("ended",onHtml5PlayerStateChange)))}))};if(v)g();else{var w="",h="";if(void 0===window.YoutubePlayerScriptLoaded&&(window.YoutubePlayerScriptLoaded=!1),void 0===window.VimeoPlayerScriptLoaded&&(window.VimeoPlayerScriptLoaded=!1),void 0===window.RutubePlayerListnersAdded&&(window.RutubePlayerListnersAdded=!1),y){if(w="YT",h="Player",!window.YoutubePlayerScriptLoaded){(P=document.createElement("script")).src="https://www.youtube.com/iframe_api";var _=document.getElementsByTagName("script")[0];_.parentNode.insertBefore(P,_),window.YoutubePlayerScriptLoaded=!0}}else if(c){var P;if(w="Vimeo",!window.VimeoPlayerScriptLoaded)(P=document.createElement("script")).src="https://player.vimeo.com/api/player.js",(document.head||document.documentElement).appendChild(P),window.VimeoPlayerScriptLoaded=!0}else u&&(window.RutubePlayerListnersAdded||window.addEventListener("message",(function(e){if(-1!==e.origin.indexOf("rutube.ru")){var a=JSON.parse(e.data);if("object"==typeof a&&a&&void 0!==a.type&&a.type){var i=!1;for(var t in players)if(void 0!==players[t].contentWindow&&players[t].contentWindow==e.source){i=t;break}if(i)switch(a.type){case"player:changeState":onRutubePlayerStateChange(i,a.data.state);break;case"player:currentTime":onRutubePlayerCurrentTime(i,a.data.time);break}}}})));if(w.length)if("object"==typeof window[w])(!h.length||h.length&&"function"==typeof window[w][h])&&g();else var b=setInterval((function(){"object"==typeof window[w]&&(!h.length||h.length&&"function"==typeof window[w][h])&&(clearInterval(b),g())}),50);else g()}}else if(void 0!==players&&players)for(var S in players)"object"==typeof window[players[S].id]&&(players[S].playing?"YOUTUBE"===players[S].videoPlayer?window[players[S].id].pauseVideo():"VIMEO"===players[S].videoPlayer?window[players[S].id].pause():"RUTUBE"===players[S].videoPlayer?document.getElementById(players[S].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[S].videoPlayer&&document.getElementById(players[S].id).pause():players[S].slideIndex==a&&("YOUTUBE"===players[S].videoPlayer?"function"==typeof window[players[S].id].playVideo&&window[players[S].id].playVideo():"VIMEO"===players[S].videoPlayer?window[players[S].id].play():"RUTUBE"===players[S].videoPlayer?document.getElementById(players[S].id).contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):"HTML5"===players[S].videoPlayer&&document.getElementById(players[S].id).play()))}}var CoverPlayer=function(){$(".banners-big .video.cover:visible").each((function(){var e=$(this).closest(".wrapper_video"),a=e[0].getBoundingClientRect().height,i=e[0].getBoundingClientRect().width,t=$(this).attr("data-video_proportion");void 0===t&&(t=16/9);var n=i,r=i/t;r<a&&(n=a*t,r=a),$(this).width(n).height(r)}))};function onVimeoPlayerReady(e){var a=this.element.id.replace("player_","");if(a){var i=players[a].mute,t=players[a].cover,n=$("#player_"+a).closest(".main-slider__item"),r=$("#player_"+a).closest(".main-slider__item:not(.swiper-slide-active)").length;if((i||r)&&window[players[a].id].setVolume(0),t&&!players[a].videoProportion){var d=window[players[a].id].getVideoWidth(),l=window[players[a].id].getVideoHeight();d.then((function(e){var i=e;l.then((function(e){var t=e;players[a].videoWidth=i,players[a].videoHeight=t,players[a].videoProportion=i/t,n.find(".video").attr("data-video_proportion",players[a].videoProportion),CoverPlayer()}))}))}if(r)setTimeout((function(){window[players[a].id].pause()}),100);else{pauseMainBanner();var s=window[players[a].id].play();void 0!==s&&s.catch((function(){setTimeout((function(){window[players[a].id].setVolume(0),window[players[a].id].play()}),100)}))}n.addClass("started")}}function onVimeoPlayerStateChange(e){var a=this.element.id.replace("player_","");if(a){players[a].cover;var i=players[a].loop,t=players[a].slideIndex,n=$("#player_"+a).closest(".main-slider__item:not(.swiper-slide-active)").length;window[players[a].id].getPaused().then((function(e){e?(players[a].playing=!1,setSlideClasses(a,!1),window[players[a].id].getCurrentTime().then((function(e){var i=Math.floor(10*e)/10;window[players[a].id].setCurrentTime(i).then((function(e){for(var r in players)players[r].slideIndex==t&&(r!=a||n&&r==a)&&window[players[r].id]&&(window[players[r].id].pause(),window[players[r].id].setCurrentTime(i).then((function(e){})))}))}))):(setSlideClasses(a,!0),window[players[a].id].getEnded().then((function(e){e?(players[a].playing=!1,i?window[players[a].id].play():playMainBanner()):(players[a].playing=!0,pauseMainBanner())})))}))}}function onRutubePlayerReady(e){if(e){var a=players[e].mute,i=players[e].cover,t=document.getElementById(players[e].id),n=$("#player_"+e).closest(".main-slider__item"),r=$(t).closest(".main-slider__item:not(.swiper-slide-active)").length;(a||r)&&t.contentWindow.postMessage(JSON.stringify({type:"player:mute",data:{}}),"*"),i&&CoverPlayer(),r?setTimeout((function(){t.contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*")}),100):(pauseMainBanner(),t.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*")),n.addClass("started")}}function onRutubePlayerCurrentTime(e,a){e&&(players[e].time=a)}function onRutubePlayerStateChange(e,a){if(e){var i=players[e].loop,t=players[e].slideIndex,n=document.getElementById(players[e].id),r=$(n).closest(".main-slider__item:not(.swiper-slide-active)").length;if("playing"===a)setSlideClasses(e,!0),players[e].playing=!0,pauseMainBanner();else if("paused"===a){setSlideClasses(e,!1),players[e].playing=!1;var d=Math.floor(10*players[e].time)/10;for(var l in n.contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:d}}),"*"),players)players[l].slideIndex==t&&(l!=e||r&&l==e)&&document.getElementById(players[l].id)&&(document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"),document.getElementById(players[l].id).contentWindow.postMessage(JSON.stringify({type:"player:setCurrentTime",data:{time:d}}),"*"))}else"stopped"===a&&(setSlideClasses(e,!1),players[e].playing=!1,i?n.contentWindow.postMessage(JSON.stringify({type:"player:play",data:{}}),"*"):playMainBanner())}}function onHtml5PlayerReady(e){var a=e.target.id.replace("player_","");if(a){var i=players[a].mute,t=players[a].cover,n=$(e.target).closest(".main-slider__item:not(.swiper-slide-active)").length,r=$("#player_"+a).closest(".main-slider__item");if((i||n)&&$("#"+players[a].id).prop("muted",!0),t){if(!players[a].videoProportion){var d=r.find(".video")[0].videoWidth,l=r.find(".video")[0].videoHeight;players[a].videoWidth=d,players[a].videoHeight=l,players[a].videoProportion=d/l,r.find(".video").attr("data-video_proportion",players[a].videoProportion)}CoverPlayer()}if(n)e.target.pause();else{pauseMainBanner();var s=e.target.play();void 0!==s&&s.catch((function(){setTimeout((function(){$("#"+players[a].id).prop("muted",!0),e.target.play()}),100)}))}r.addClass("started")}}function onHtml5PlayerStateChange(e){var a=e.target.id.replace("player_","");if(a){players[a].cover;var i=$(e.target).closest(".main-slider__item:not(.swiper-slide-active)").length,t=players[a].loop,n=players[a].slideIndex;if(e.target.paused&&!e.target.ended){players[a].playing=!1,setSlideClasses(a,!1);var r=Math.floor(10*e.target.currentTime)/10;for(var d in e.target.currentTime=r,players)players[d].slideIndex==n&&(d!=a||i&&d==a)&&document.getElementById(players[d].id)&&(document.getElementById(players[d].id).pause(),document.getElementById(players[d].id).currentTime=r);pauseMainBanner(),playMainBanner()}else e.target.ended?(players[a].playing=!1,t?(setSlideClasses(a,!1),e.target.play()):(pauseMainBanner(),playMainBanner(),nextSlideMainBanner())):(players[a].playing=!0,setSlideClasses(a,!0),pauseMainBanner())}}function setSlideClasses(e,a){const i=document.querySelector(`#player_${e}`).closest(".main-slider__item"),t=i.querySelector(".banners-big__inner .btn-video"),n=t.querySelector("use"),r=`${arAsproOptions.SITE_TEMPLATE_PATH}/images/svg/video_buttons_sprite.svg`;a?(i.classList.add("loading"),t.classList.add("loading"),n.setAttribute("href",`${r}#video-pause-13-13`)):(i.classList.remove("loading"),t.classList.remove("loading"),n.setAttribute("href",`${r}#video-play-13-13`))}waitYTPlayer=function(e,a){"undefined"!=typeof YT&&YT&&YT.Player?"function"==typeof a&&a():setTimeout((function(){waitYTPlayer(e,a)}),e)},$(document).on("click","video.video",(function(e){var a=e.target.id.replace("player_","");a&&(players[a].playing?e.target.pause():e.target.play())})),$(document).on("click",".banners-big .btn-video",(function(e){e.stopPropagation(),startMainBannerSlideVideo($(this).closest(".main-slider__item"))})),$(document).on("click",".banners-big .banners-big__item",(function(e){var a=$(this),i=a.hasClass("vvideo"),t=a.hasClass("wurl");if(!$(e.target).hasClass("btn"))if(t){var n=a.find(".target").attr("href");if(n.length){var r=a.find(".target").attr("target");void 0===r||"_self"===r?location.href=n:window.open(n)}}else i&&(e.stopPropagation(),$(this).find(".btn-video").trigger("click"))})),getRandomInt=function(e,a){return Math.floor(Math.random()*(a-e))+e};var lastSlideIndex,ignoreResize=[];BX.addCustomEvent("onWindowResize",(function(e){try{CoverPlayer()}catch(e){}finally{ignoreResize.pop()}})),BX.addCustomEvent("onSlideEnd",(function(e){try{if(ignoreResize.push(!0),e)e.slider&&setTimeout((function(){$(".banners-big.front .btn-video, .banners-big.front .banners-big__item").removeClass("loading")}),300)}catch(e){}finally{ignoreResize.pop()}})),BX.addCustomEvent("onSlide",(function(e){try{if(ignoreResize.push(!0),e){var a=e.slider;if(a){let e="";if(a.data("swiper")){const i=a.data("swiper").realIndex;e=a.find(`.main-slider__item[data-slide_index=${i}]`)}else e=a.find(".swiper-slide-active").length?a.find(".swiper-slide-active").first():a.find(".main-slider__item:not(.swiper-slide-duplicate)").eq(0);e.length||(e=a.find(".box.swiper-slide-active"));var i=e.attr("data-slide_index");if(lastSlideIndex===i)return;if(lastSlideIndex=i,void 0!==e&&e.length){var t=a.data("slidesIndexesWithVideo");if(void 0===t&&(t=[]),-1!=t.indexOf(i)?a.addClass("video_visible"):a.removeClass("video_visible"),setTimeout((function(){CoverPlayer()}),200),void 0!==players&&players)for(var n in players)players[n].slideIndex!=i&&"object"==typeof window[players[n].id]&&("YOUTUBE"===players[n].videoPlayer?window[players[n].id].pauseVideo():"VIMEO"===players[n].videoPlayer?window[players[n].id].pause():"RUTUBE"===players[n].videoPlayer?document.getElementById(players[n].id).contentWindow.postMessage(JSON.stringify({type:"player:pause",data:{}}),"*"):"HTML5"===players[n].videoPlayer&&document.getElementById(players[n].id).pause());1==e.attr("data-video_autoplay")&&startMainBannerSlideVideo(e)}if(e.find("video").length&&!e.find(".btn-video").length){var r=e.find("video").attr("id");document.getElementById(r).play()}}}}catch(e){}finally{ignoreResize.pop()}}));