var selectedThematic=arAsproOptions.THEMATICS.VALUE,restoreThematics=function(){selectedThematic=arAsproOptions.THEMATICS.VALUE,selectThematic(selectedThematic,!1)},selectThematic=function(e,t){var s=s=$(".presets .thematik .item[data-code="+e+"]");if(s.length&&"object"==typeof arAsproOptions.THEMATICS.LIST[e]){for(var a in selectedThematic=e,s.addClass("active").siblings().removeClass("active"),$(".presets .presets_subtabs .presets_subtab .desc").html("&mdash;"),$(".presets .presets_subtabs .presets_subtab:first .desc").text(arAsproOptions.THEMATICS.LIST[e].TITLE),$(".presets .presets_block .conf .item").addClass("hidden"),$(".presets .presets_block .conf .item .js-addpreset").closest(".item").removeClass("hidden"),"object"!=typeof BX.admin&&$(".presets .presets_block .conf .apply_conf_block").addClass("hidden"),$(".presets .presets_block .conf .item .preset-block.current").removeClass("current"),arAsproOptions.THEMATICS.LIST[e].PRESETS.LIST){var o=arAsproOptions.THEMATICS.LIST[e].PRESETS.LIST[a],i=$(".presets .presets_block .conf .item .preset-block[data-id="+o+"]");i.length&&"object"==typeof arAsproOptions.PRESETS.LIST[o]&&(i.closest(".item").removeClass("hidden"),arAsproOptions.THEMATICS.LIST[e].URL.length&&i.find(".apply_conf_block").removeClass("hidden"),arAsproOptions.THEMATICS.VALUE==e&&(i.find(".apply_conf_block").removeClass("hidden"),arAsproOptions.PRESETS.VALUE==o&&(i.addClass("current"),$(".presets .presets_subtabs .presets_subtab:last .desc").text(arAsproOptions.PRESETS.LIST[o].TITLE))))}void 0!==t&&t&&$(".presets .presets_subtabs .presets_subtab").last().trigger("click")}else;},selectPreset=function(e){var t=$(".style-switcher .presets .preset-block[data-id="+e+"]");if(t.length){if(t.hasClass("current")||t.hasClass("editing"))return;if("object"==typeof arAsproOptions.PRESETS.LIST[e]){var s=-1!==location.hostname.indexOf("dev.aspro.ru"),a=!s&&"object"==typeof arAsproOptions.THEMATICS.LIST[selectedThematic]&&arAsproOptions.THEMATICS.LIST[selectedThematic].URL.length&&"Y"===arAsproOptions.USE_DEMO_LINK;!s&&!a&&selectedThematic!=arAsproOptions.THEMATICS.VALUE?prepareWizard(selectedThematic,e):($(".style-switcher .presets .preset-block.current").removeClass("current"),t.addClass("current"),t.closest(".presets").find(".presets_subtab.active .desc").text(t.find(".info .title").text()),setConfiguration(selectedThematic,e))}}},setConfiguration=function(e,t){"object"==typeof arAsproOptions.THEMATICS.LIST[e]&&("object"==typeof arAsproOptions.PRESETS.LIST[t]&&(!(-1!==location.hostname.indexOf("dev.aspro.ru"))&&arAsproOptions.THEMATICS.LIST[e].URL.length&&e!==arAsproOptions.THEMATICS.VALUE?location.href=arAsproOptions.THEMATICS.LIST[e].URL+"?preset="+t:$.ajax({type:"POST",data:{thematic:e,preset:t},success:function(){$(".style-switcher .presets_action").trigger("click"),setTimeout((function(){location.href=location.href}),300)}})))};"undefined"==typeof prepareWizard&&(prepareWizard=function(e,t){"object"==typeof arAsproOptions.THEMATICS.LIST[e]&&"object"==typeof arAsproOptions.PRESETS.LIST[t]&&$.ajax({url:$(".style-switcher .contents.wizard").data("script"),type:"POST",data:{action:"getform",thematic:e,preset:t,lang:BX.message.LANGUAGE_ID},success:function(e){$(".style-switcher .contents.wizard").html(e),$(".style-switcher .contents.wizard").addClass("active")}})}),$(document).ready((function(){$(".refresh-block.sup-params .values .inner-wrapper").each((function(){var e=$(this),t=e[0];Sortable.create(t,{handle:".drag",animation:150,forceFallback:!0,filter:".no_drag",preventOnFilter:!1,onStart:function(e){e.oldIndex,window.getSelection().removeAllRanges(),$(e.item).find(".template_block, .bottom-options").addClass("hidden")},onEnd:function(e){$(e.item).find(".template_block, .bottom-options").removeClass("hidden")},onMove:function(e){return-1===e.related.className.indexOf("no_drag")},onUpdate:function(t){var s=t.item,a=[],o=e.data("key"),i="SORT_ORDER_INDEX_TYPE_"+o;$(s).find(".template_block, .bottom-options").removeClass("hidden"),e.find(".option-wrapper").each((function(){a.push($(this).find('.blocks input[type="checkbox"]').attr("name").replace(o+"_",""));let e=$(this).index()+1,t=$('div[data-class="'+$(this).find('.blocks input[type="checkbox"]').attr("name").toLowerCase().replace(o+"_","")+'_drag"]');t.attr("data-order",e),t[0]&&t[0].style.setProperty("--order-index",e)})),$("input[name="+i+"]").val(a.join(",")),$(".sharepreset-part--export").removeClass("sharepreset-part--exported2Link"),$.post(arAsproOptions.SITE_DIR+"ajax/options_save_mainpage.php",{VALUE:a.join(","),NAME:i}).done((function(){$(".style-switcher .parametrs .action_block").addClass("can_save"),$(".style-switcher .right-block .inner-content").addClass("with-action-block")}));BX.onCustomEvent("onCompleteAction",[{action:"jsLoadBlock"}])}})})),$(".color_custom input[type=hidden]").length&&$(".color_custom input[type=hidden]").each((function(){var e=$(this),t=$(this).closest(".color_custom"),s=$(this).closest(".options");e.spectrum({preferredFormat:"hex",showButtons:!0,showInput:!0,showPalette:!1,appendTo:t,chooseText:BX.message("CUSTOM_COLOR_CHOOSE"),cancelText:BX.message("CUSTOM_COLOR_CANCEL"),containerClassName:"custom_picker_container",replacerClassName:"custom_picker_replacer",clickoutFiresChange:!1,move:function(e){var s=e.toHexString();t.find("span span.bg").attr("style","background:"+s)},hide:function(e){var s=e.toHexString();t.find("span span.bg").attr("style","background:"+s)},change:function(e){var a=e.toHexString();t.addClass("current").siblings().removeClass("current"),t.find("span span.vals").text(a),t.find("span.animation-all").attr("style","border-color:"+a),checkDelay(s),$("form[name=style-switcher] input[name="+t.find(".click_block").data("option-id")+"]").val(t.find(".click_block").data("option-value")),$("form[name=style-switcher]").submit()}})})),$(".color_custom").click((function(e){return e.preventDefault(),$("input[name="+$(this).data("name")+"]").spectrum("toggle"),!1})),$(".base_color.current").length&&$(".base_color.current").each((function(){var e=$(this).closest(".options").find(".color_custom"),t=$(this).data("color");null!=t&&t.length&&($("input[name="+e.data("name")+"]").spectrum("set",t),e.find("span span").attr("style","background:"+t))})),$(".style-switcher .on-off-switch").on("click",(function(){var e=$(this).prev();if(e.is("input[type=checkbox]")){var t=e.attr("name"),s=!e.prop("checked");if($(this).hasClass("wait"))return!1;$(this).addClass("wait"),e.prop("checked",s).trigger("change"),setTimeout((function(){if(-1!=window.array.indexOf(t))return!1;window.array.push(t),setTimeout((function(){window.array.splice(window.array.indexOf(t),1)}),500);var a=e.closest(".values").length&&!e.closest(".subs").length||e.closest(".option-ajax").length,o=e.closest(".options");if(s?e.val("Y"):e.val("N"),a){var i,n=$('<div class="btn-ajax-block animation-opacity"></div>'),r=e.closest(".option-wrapper"),c=BX.pos(r[0],!0),l=e.closest(".inner-wrapper").data("key"),p=t.replace(l+"_","");n.html($(".values > .apply-block").html()),i=c.top+$(".style-switcher .header").actual("outerHeight"),n.css("top",i),$(".btn-ajax-block").length&&$(".btn-ajax-block").remove(),n.appendTo($(".style-switcher")),n.addClass("opacity1"),s?("WITH_LEFT_BLOCK"==p&&($(".wrapper_inner.front").removeClass("wide_page"),$(".wrapper1.front_page").addClass("with_left_block"),$(".wrapper_inner.front .container_inner > .right_block").removeClass("wide_Y").addClass("wide_N"),$(".wrapper_inner.front .container_inner > .left_block").removeClass("hidden"),void 0!==window.stickySidebar&&window.stickySidebar.updateSticky()),$(".drag-block[data-class="+p.toLowerCase()+"_drag]").removeClass("hidden"),$(".templates_block .item."+t).removeClass("hidden"),$(window).resize(),"BIG_BANNER_INDEX"==p?($("body").addClass("header_opacity"),$(window).resize()):"MAPS"==p&&"undefined"!=typeof map&&"undefined"!=typeof clusterer&&setTimeout((function(){map.setBounds(clusterer.getBounds(),{zoomMargin:40})}),200)):($(".drag-block[data-class="+p.toLowerCase()+"_drag]").addClass("hidden"),$(".templates_block .item."+t).addClass("hidden"),"WITH_LEFT_BLOCK"==p&&($(".wrapper_inner.front").addClass("wide_page"),$(".wrapper1.front_page").removeClass("with_left_block"),$(".wrapper_inner.front .container_inner > .right_block").removeClass("wide_N wide_").addClass("wide_Y"),$(".wrapper_inner.front .container_inner > .left_block").addClass("hidden"),$(window).resize()),"BIG_BANNER_INDEX"==p&&$("body").removeClass("header_opacity"));BX.onCustomEvent("onCompleteAction",[{action:"jsLoadBlock"}]);$(this.el),$(this.el).closest(".option-ajax"),$(this.el).closest(".option-ajax-target")}checkDelay(o),setTimeout((function(){a||$("form[name=style-switcher]").submit()}),200)}),300)}}));const e=throttle((function(e){var t=e.target.scrollTop;$.cookie("STYLE_SWITCHER_SCROLL_PARAMETERS",t,{path:arAsproOptions.SITE_DIR})}),500);$(".style-switcher .contents.parametrs .right-block").on("scroll",e),$.cookie("STYLE_SWITCHER_SCROLL_PARAMETERS")&&(document.querySelector(".right-block.scrollbar").scrollTop=$.cookie("STYLE_SWITCHER_SCROLL_PARAMETERS")),$(".style-switcher .item input[type=checkbox]").on("change",(function(){$(".sharepreset-part--export").removeClass("sharepreset-part--exported2Link");var e=$(this),t=e.closest(".option-wrapper"),s=!e.closest(".sub-item").length&&!e.closest(".filter").length;e.is(":checked")?(e.val("Y"),t.removeClass("disabled")):(e.val("N"),s&&t.addClass("disabled")),void 0!==e.data("dynamic")||e.closest(".option-ajax")?(e.data("index_block")&&e.data("index_class")&&$(".drag-block.container."+e.data("index_block")+" .index-block").toggleClass("index-block--"+e.data("index_class")),$.post(arAsproOptions.SITE_DIR+"ajax/options_save_mainpage.php",{VALUE:e.val(),NAME:e.attr("name")},(function(){var t={element:e,ajaxParent:e.closest(".option-ajax"),checked:e.is(":checked")};reloadBlock(t),$(".style-switcher .parametrs .action_block").addClass("can_save"),$(".style-switcher .right-block .inner-content").addClass("with-action-block"),e.next().removeClass("wait")}))):$("form[name=style-switcher]").submit()})),$(".sup-params .values .subtitle").click((function(){var e=$(this).closest(".option-wrapper");e.find(".template_block > .item").is(":visible")?$.removeCookie("STYLE_SWITCHER_TEMPLATE"+e.index(),{path:arAsproOptions.SITE_DIR}):$.cookie("STYLE_SWITCHER_TEMPLATE"+e.index(),"Y",{path:arAsproOptions.SITE_DIR}),e.find(".template_block .item").slideToggle(),e.find(".bottom-options").slideToggle(),e.find(".bottom-options").toggleClass("active")})),$(".presets .presets_subtabs .presets_subtab").on("click",(function(){var e=$(this);e.siblings().removeClass("active"),e.addClass("active"),$(".presets .presets_block .options").removeClass("active"),e.closest(".presets").find(".options:eq("+e.index()+")").addClass("active"),0==e.index()&&restoreThematics(),$.cookie("STYLE_SWITCHER_CONFIG_BLOCK",e.index(),{path:arAsproOptions.SITE_DIR})})),$(".style-switcher").on("click",".can_save .save_btn",(function(){var e=$(this);timerHide&&(clearTimeout(timerHide),timerHide=!1),$.ajax({type:"POST",url:arAsproOptions.SITE_DIR+"ajax/options_save.php",data:{SAVE_OPTIONS:"Y"},dataType:"json",success:function(t){"STATUS"in t&&($(".save_config_status").length||$('<div class="save_config_status" style="display:none"><span></span></div>').appendTo(e.parent()),"OK"===t.STATUS?$(".save_config_status").addClass("success"):$(".save_config_status").addClass("error"),$(".save_config_status span").text(BX.message(t.MESSAGE)),$(".save_config_status").fadeIn(600,(function(){timerHide=setTimeout((function(){$(".save_config_status").fadeOut(600,(function(){$(this).remove(),$(".style-switcher .parametrs .action_block").removeClass("can_save"),$(".style-switcher .right-block .inner-content").removeClass("with-action-block")}))}),1e3)})))}})})),$('.item.groups-tab a[data-toggle="tab"].linked').on("shown.bs.tab",(function(e){var t=$(this);$.cookie("styleSwitcherTabs"+t.closest(".tabs").data("parent"),t.parent().index(),{path:"/"})})),$(".style-switcher .section-block").on("click",(function(){var e=$(this);e.addClass("active").siblings().removeClass("active"),$(".style-switcher .right-block .contents."+e.data("type")).addClass("active").siblings().removeClass("active"),$.cookie("styleSwitcher","open",{path:"/"}),$.cookie("styleSwitcherType",e.data("type"),{path:"/"}),(e.hasClass("share_tab")||e.hasClass("demos_tab")||e.hasClass("updates_tab"))&&($.removeCookie("styleSwitcherType",{path:"/"}),$.removeCookie("styleSwitcher",{path:"/"}),e.is(".share_tab.loading_state")&&$(".style-switcher .contents.share").length&&$.ajax({url:$(".style-switcher .contents.share").data("script"),type:"POST",data:{siteId:arAsproOptions.SITE_ID,siteDir:arAsproOptions.SITE_DIR,lang:BX.message.LANGUAGE_ID},beforeSend:function(){e.addClass("loading_state"),$(".style-switcher .contents.share").addClass("form sending")},success:function(e){$(".style-switcher .contents.share").html(e)},error:function(e){console.log(e)},complete:function(){e.removeClass("loading_state"),$(".style-switcher .contents.share").removeClass("form sending")}}))})),$(".style-switcher .subsection-block").on("click",(function(){$(this).siblings().removeClass("active"),$(this).addClass("active"),$(".style-switcher .right-block .contents .content-body .block-item").removeClass("active"),$(".style-switcher .right-block .contents .content-body .block-item:eq("+$(this).index()+")").addClass("active"),$(".style-switcher [class*=_BACK_BUTTON]").hide(),$.cookie("styleSwitcherSubType",$(this).index(),{path:"/"})})),$(".style-switcher .reset").click((function(e){$("form[name=style-switcher]").append('<input type="hidden" name="THEME" value="default" />'),$("form[name=style-switcher]").submit(),$.removeCookie("styleSwitcherTabsCatalog",{path:"/"})})),$(".style-switcher .ext_hint_title").click((function(){var e=$(this);$(".dynamic_left_side").length&&$(".dynamic_left_side").remove(),$('<div class="dynamic_left_side scrollbar"><div class="items_inner"></div></div>').appendTo(e.closest(".contents.parametrs > .right-block")),$('<div class="cl" title="'+BX.message("FANCY_CLOSE")+'">'+$(".close_block .closes").html()+"</div>").appendTo($(".dynamic_left_side")),$(".ext_hint_desc").find("iframe").attr("src",$(".ext_hint_desc").find("iframe").data("src")),$(".dynamic_left_side .items_inner").html(e.siblings(".ext_hint_desc").html()),timerDynamicLeftSide&&(clearTimeout(timerDynamicLeftSide),timerDynamicLeftSide=!1),timerDynamicLeftSide=setTimeout((function(){$(".dynamic_left_side").addClass("active")}),100)})),$(".style-switcher .sup-params.options .block-title").click((function(){$(this).next().slideToggle()})),$(".style-switcher .options > .link-item,.style-switcher .options > div:not(.color_custom) .link-item,.style-switcher .options > div:not(.color_custom) .click_block").click((function(e){var t=$(this),s="multi"==t.data("type"),a=t.hasClass("current"),o=t.closest(".options");if(!(e&&e.target&&$(e.target).closest(".toggle-parent").length)&&((!a||e&&e.target&&($(e.target).closest(".switcher-select").length||$(e.target).closest(".checkbox-wrapper").length))&&(void 0!==$(this).data("option-type")&&$.cookie("scroll_block",$(this).data("option-type")),void 0!==$(this).data("option-url")&&$("form[name=style-switcher]").prepend('<input type="hidden" name="backurl" value='+$(this).data("option-url")+" />")),(s||!a)&&(!e||!e.target||a||!$(e.target).closest(".switcher-select").length))){if(s?t.toggleClass("current"):(t.closest(".subs").length||t.closest(".options").find(".link-item").removeClass("current"),t.addClass("current").siblings().removeClass("current")),s){var i=$("form[name=style-switcher] input[name="+t.data("option-id")+"]"),n=i.val();n?(n=n.split(","),a?n.splice(n.indexOf(t.data("option-value")),1):n.push(t.data("option-value")),n=n.join(),i.val(n)):i.val(t.data("option-value"))}else $("form[name=style-switcher] input[name="+t.data("option-id")+"]").val(t.data("option-value"));if(t.closest(".sup-params").length&&$.removeCookie("styleSwitcher",{path:"/"}),checkDelay(o),"Y"===o.data("ajax")||"Y"===t.data("ajax")){const e=t.data("option-value").toLowerCase();"THEME_VIEW_COLOR"===t.data("option-id")&&($("body").removeClass("theme-default theme-dark theme-light"),$("body").addClass("theme-"+e),$(".jqmOverlay").trigger("click"));var r={VALUE:t.data("option-value"),NAME:t.data("option-id"),SHOW_ACTION_PANEL:!0};saveFrontParameter(r),"THEME_VIEW_COLOR"===t.data("option-id")&&BX.onCustomEvent("onChangeThemeColor",[{value:e}])}else if(t.closest(".options").hasClass("refresh-block")){if(!t.closest(".options").hasClass("sup-params"))t.index();t.closest(".item").find(".sup-params.options").removeClass("active"),t.closest(".item").find(".sup-params.options.s_"+t.data("option-value")).addClass("active"),$("form[name=style-switcher]").submit()}else $("form[name=style-switcher]").submit()}})),$(".tooltip-link").on("shown.bs.tooltip",(function(e){var t=$(this).next(),s=($(window).height(),$(this).closest("form").scrollTop(),BX.pos($(this)[0],!0)),a=BX.pos(t[0],!0),o=BX.pos($(this).closest(".item")[0],!0);!$(this).closest(".item").next().length&&a.bottom>o.bottom&&(t.removeClass("bottom").addClass("top"),t.css({top:s.top-t.actual("outerHeight")}))}))}));